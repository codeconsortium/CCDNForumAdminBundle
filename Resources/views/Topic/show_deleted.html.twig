{% extends param('ccdn_forum_admin.topic.show_deleted.layout_template') %}

{% block stylesheets %}
	{{ parent() }}
	<link href="{{ asset('bundles/ccdncomponentcrumbtrail/css/crumbs.css') }}" rel="stylesheet" type="text/css">
{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script src="{{ asset('bundles/ccdncomponentcommon/js/jquery.checkboxes.js') }}" type="text/javascript"></script>
{% endblock %}

{% block title %}{{ 'title.topic.deleted' | trans({}, 'CCDNForumAdminBundle') }}{% endblock %}

{% block sidebar %}
	{{ parent() }}

	{% include 'CCDNForumAdminBundle:Sidebar:sidebar.html.twig' %}

{% endblock %}


{% block body %}

	{% include 'CCDNComponentCommonBundle:Flashes:flashes.html.twig' %}

	{% include 'CCDNComponentCrumbTrailBundle:Trail:trail.html.twig' with {'crumbs': crumbs } %}

	<h2>{{ 'title.topic.deleted' | trans({}, 'CCDNForumAdminBundle') }}</h2>

	<form method="POST" action="{{ path('cc_admin_forum_topics_bulk_action') }}">
	
	<input type="submit" class="btn btn-primary" value="{{ 'link.topic.close' |trans({}, 'CCDNForumAdminBundle') }}" name="submit_close">
	<input type="submit" class="btn btn-primary" value="{{ 'link.topic.reopen' |trans({}, 'CCDNForumAdminBundle') }}" name="submit_reopen">
	<input type="submit" class="btn btn-primary" value="{{ 'link.topic.restore' |trans({}, 'CCDNForumAdminBundle') }}" name="submit_restore">
	<input type="submit" class="btn btn-primary" value="{{ 'link.topic.delete.soft' |trans({}, 'CCDNForumAdminBundle') }}" name="submit_soft_delete">
	<input type="submit" class="btn btn-danger" value="{{ 'link.topic.delete.hard' |trans({}, 'CCDNForumAdminBundle') }}" name="submit_hard_delete">

	<br><br>
	{% if pager.haveToPaginate %}
		{{ pagerfanta(pager, 'twitter_bootstrap', {'routeName':'cc_admin_forum_topic_deleted_show_paginated', 'routeParams':{}} ) }}
	{% endif %}
	
	<table class="table table-striped table-bordered">
		<thead>
			<tr>
				<th class="center" style="width:18px;"><input type="checkbox" id="check_all" name="check_all"></th>
				<th class="center" style="width:18px;"></th>
				<th class="center" style="width:18px;"><i class="icon-lock"></i></th>
				<th class="center" style="width:18px;"><i class="icon-trash"></i></th>
				<th class="left">{{ 'board.table.head.topic_title' | trans({}, 'CCDNForumForumBundle') }}</th>
				<th class="center">{{ 'board.table.head.reply_count' | trans({}, 'CCDNForumForumBundle') }}</th>
				<th class="center">{{ 'board.table.head.view_count' | trans({}, 'CCDNForumForumBundle') }}</th>
				<th class="center">{{ 'board.table.head.closed_by' | trans({}, 'CCDNForumForumBundle') }}</th>
				<th class="center">{{ 'board.table.head.closed_on' | trans({}, 'CCDNForumForumBundle') }}</th>
				<th class="center">{{ 'board.table.head.deleted_by' | trans({}, 'CCDNForumForumBundle') }}</th>
				<th class="center">{{ 'board.table.head.deleted_on' | trans({}, 'CCDNForumForumBundle') }}</th>
			</tr>
		</thead>
		<tbody>
			{% for row, topic in topics %}
				<tr class="{{ cycle(['row_odd', 'row_even'], row) }}">
					<td class="center">
						<input type="checkbox" id="topic_{{ topic.id }}" name="check_{{ topic.id }}">
					</td>
					<td class="center">
						<a href="{{ path('cc_forum_topic_show', {'topic_id': topic.getId }) }}"><i class="icon-comment"></a>
					</td>
					<td class="center">
						{% if topic.getClosedBy %}
						<i class="icon-lock"></i>
						{% endif %}
					</td>
					<td class="center">
						{% if topic.getDeletedBy %}
						<i class="icon-trash"></i>
						{% endif %}
					</td>
					<td class="left">
						<a class="topic_link" href="{{ path('cc_forum_topic_show', {'topic_id': topic.getId }) }}" title="{{ topic.getTitle }}">{{ truncDot(topic.getTitle, param('ccdn_forum_admin.topic.show_deleted.topic_title_truncate')) }}</a><br>
						{{ 'post.posted_by' | trans({}, 'CCDNForumForumBundle') }}
						{% if topic.getFirstPost %}
							{% if topic.getFirstPost.getCreatedBy %}
								<a href="{{ path(user_profile_route, {'user_id': topic.getFirstPost.getCreatedBy.getId } ) }}">{{ topic.getFirstPost.getCreatedBy |title }}</a>
							{% else %}
								Guest
							{% endif %}
						{% endif %}
					</td>
					<td class="center">
						{{ topic.getReplyCount }}
					</td>
					<td class="center">
						{{ topic.getViewCount }}
					</td>

					<td class="center">
						{% if topic.getClosedBy %}<a href="{{ path(user_profile_route, {'user_id': topic.getClosedBy.getId }) }}">{{ topic.getClosedBy.getUsername |title }}</a>{% endif %}
					</td>
					<td class="center">
						{% if topic.getClosedDate %}{{ topic.getClosedDate |date(param('ccdn_forum_admin.topic.show_deleted.topic_closed_datetime_format')) }}{% endif %}
					</td>

					<td class="center">
						{% if topic.getDeletedBy %}<a href="{{ path(user_profile_route, {'user_id': topic.getDeletedBy.getId }) }}">{{ topic.getDeletedBy.getUsername |title }}</a>{% endif %}
					</td>
					<td class="center">
						{% if topic.getDeletedDate %}{{ topic.getDeletedDate |date(param('ccdn_forum_admin.topic.show_deleted.topic_deleted_datetime_format')) }}{% endif %}
					</td>
				</tr>
			{% else %}
				<tr>
					<td class="center" colspan="11">
						{{ 'topics.deleted.table.empty' | trans({}, 'CCDNForumAdminBundle') }}
					</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
	
	{% if pager.haveToPaginate %}
	    {{ pagerfanta(pager, 'twitter_bootstrap', {'routeName':'cc_admin_forum_topic_deleted_show_paginated', 'routeParams':{}} ) }}
	{% endif %}
	
	</form>
	
	{% include 'CCDNComponentCrumbTrailBundle:Trail:trail.html.twig' with {'crumbs': crumbs } %}

{% endblock %}